#!/bin/sh
. "$(dirname "$0")/husky.sh"

STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|ts|jsx|tsx|json|css|md)$')

if [ -z "$STAGED_FILES" ]; then
  echo "No files to format. Proceeding with commit."
  exit 0
fi

echo "Running Prettier on staged files..."
echo "$STAGED_FILES" | xargs yarn prettier --write

if [ -n "$(git status --porcelain)" ]; then
  echo "Prettier made changes. Please stage the changes and commit again."
  exit 1
fi

echo "Prettier check passed. Proceeding with commit."
