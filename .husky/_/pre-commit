#!/bin/sh
. "$(dirname "$0")/husky.sh"

# Get list of staged files matching known Prettier file extensions
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|ts|jsx|tsx|json|css|scss|md|html|yml|yaml)$')

if [ -z "$STAGED_FILES" ]; then
  echo "No staged files to format. Proceeding with commit."
  exit 0
fi

echo "Running Prettier on staged files..."
echo "$STAGED_FILES" | xargs yarn prettier --write

echo "Re-staging formatted files..."
echo "$STAGED_FILES" | xargs git add

echo "Prettier formatting and staging complete. Proceeding with commit."
